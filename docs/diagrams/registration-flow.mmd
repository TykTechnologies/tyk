flowchart LR
    Start["API Spec Loaded"]
    Extract["Extract Cert Refs<br/>from all fields"]
    Dedup["Deduplicate with<br/>map[string]struct{}"]
    Register["Register in<br/>certsByAPI"]
    MarkReq["Mark as required<br/>in registry"]
    Track["Track APIâ†’Cert<br/>in apisByCert"]

    Start --> Extract
    Extract --> Dedup
    Dedup --> Register
    Register --> MarkReq
    MarkReq --> Track