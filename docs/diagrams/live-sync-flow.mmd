flowchart LR
    Detect["Control plane detects certificate update"]
    Publish["Publish keyspace change event"]
    Receive["Data plane receives event"]
    Check{"Check if cert is required<br/>registry.Required()"}
    SyncCert["Sync certificate"]
    Skip["Skip (log debug message)"]

    Detect --> Publish
    Publish --> Receive
    Receive --> Check
    Check -->|Yes| SyncCert
    Check -->|No| Skip